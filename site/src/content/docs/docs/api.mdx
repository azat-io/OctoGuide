---
description: OctoGuide's 'octoguide' package and exports.
title: API
---

import { PackageManagers } from "starlight-package-managers";

OctoGuide provides an [`octoguide`](https://www.npmjs.com/package/octoguide) package on npm.
This package is the same as the [standalone CLI](/cli) and its code is directly used by the [GitHub Action](/get-started#installation).

<PackageManagers pkg="octoguide" type="install" />

## `runOctoGuideRules`

Runs OctoGuide's rules to generate a list of reports for a GitHub entity.
The entity will be fetched from its URL.

Takes in a single parameter of type [`RunOctoGuideRulesOptions`](#runoctoguiderulesoptions).
Returns a [`RunOctoGuideRulesResult`](#runoctoguiderulesresult).

```ts
import { runOctoGuideRules } from "octoguide";

const { reports } = await runOctoGuideRules({
	entity: "https://github.com/JoshuaKGoldberg/OctoGuide/issues/19",
});

console.log("Received reports:", reports);
```

:::caution
`runOctoGuideRules` currently requires a GitHub PAT for [`octokit-from-auth`](https://www.npmjs.com/package/octokit-from-auth), such as one set by logging into the [GitHub CLI](http://cli.github.com).
It will reject if one is not available.

See (TODO FILE ISSUE) for getting rid of this requirement.
:::

### `RunOctoGuideRulesOptions`

Settings for running [`runOctoGuideRules`](#runoctoguide).
Only `entity` is required.

- `auth: string`: GitHub authentication token.
  - If not provided, retrieved with [`get-github-auth-token`](https://www.npmjs.com/package/get-github-auth-token).
- `config: "recommended" | "strict"`: Preset configuration to run rules from.
  - If not provided, defaults to `"recommended"`.
- `entity: string`: URL of the entity to run rules on.

```ts
import { runOctoGuideRules } from "octoguide";

await runOctoGuideRules({
	auth: "ghp_...",
	config: "strict",
	entity: "https://github.com/JoshuaKGoldberg/OctoGuide/issues/19",
});
```

### `RunOctoGuideRulesResult`

Settings for running [`runOctoGuideRules`](#runoctoguide).

- `entity`: [`Entity`](./types#entity): The entity that was scanned.
- `reports`: [`RuleReport[]`](./types#rulereport): Any reports generated by the rules.

```ts
const { entity, reports } = await runOctoGuideRules({
	entity: "https://github.com/JoshuaKGoldberg/OctoGuide/issues/19",
});

console.log("Entity URL:", entity.data.html_url);
console.log("Received reports:", reports);
```

## Reporters

The functions that OctoGuide itself uses to display [rule reports](#rulereport):

- [`cliReporter`](#clireporter): Used by the [standalone CLI](/cli)
- [`markdownReporter`](#markdownreporter): Used by the [GitHub Actions Workflow](/get-started#installation)

These reporters both take in a `reports: RuleReport[]` as returned by [`runOctoGuideRules`](#runoctoguide)'s [`RunOctoGuideRulesResult`](#runoctoguideRulesresult).

### `cliReporter`

Formats a [rule report](#rulereport) as used by [standalone CLI](/cli).

If reports is empty, it will log a happy _`Found 0 reports. Great! ✅`_ message.
Otherwise it will pretty-print the reports, grouped by rule.

```ts
import { cliReporter, runOctoGuideRules } from "octoguide";

const { reports } = await runOctoGuideRules({
	entity: "https://github.com/JoshuaKGoldberg/OctoGuide/issues/19",
});

console.log(cliReporter(reports));
```

### `markdownReporter`

Formats a [rule report](#rulereport) as used by the [GitHub Actions Workflow](/get-started#installation).

If reports is empty, it will log a happy _`All reports are resolved now. Thanks! ✅`_ message.
Otherwise it will pretty-print the reports, grouped by rule.

```ts
import { markdownReporter, runOctoGuideRules } from "octoguide";

const { entity, reports } = await runOctoGuideRules({
	entity: "https://github.com/JoshuaKGoldberg/OctoGuide/issues/19",
});

console.log(markdownReporter(entity, reports));
```
